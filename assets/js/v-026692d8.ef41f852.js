"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6570],{3010:(s,n,a)=>{a.r(n),a.d(n,{data:()=>t});const t={key:"v-026692d8",path:"/articles/WeApp/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93.html",title:"小程序的优化",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"遇到的问题，以及如何解决的。",slug:"遇到的问题-以及如何解决的。",children:[]},{level:2,title:"组件相关",slug:"组件相关",children:[]},{level:2,title:"其他",slug:"其他",children:[]}],filePathRelative:"articles/WeApp/小程序开发相关总结.md",git:{}}},4099:(s,n,a)=>{a.r(n),a.d(n,{default:()=>r});var t=a(6252);const e=(0,t.uE)('<h1 id="小程序的优化" tabindex="-1"><a class="header-anchor" href="#小程序的优化" aria-hidden="true">#</a> 小程序的优化</h1><p><strong>双线程架构相关</strong></p><ul><li>setData 频繁操作（底层是因为双线程架构），可以使用 wx.nextTick 将多次操作延迟到下一次事件循环里</li><li>不需要渲染的数据使用_或者直接挂在在 this 下，不要放在 data 中</li><li>双线程原因，JS 在独立线程中，setTimeout/setInterval 将作用于全局，所以使用应注意 clear 掉</li></ul><p><strong>首屏加载相关</strong></p><ul><li>图片懒加载和下拉刷新</li><li>分包和预加载（在 onLoad 总发送 http 请求）</li><li>骨架屏</li></ul><p><strong>代码相关</strong></p><ul><li>减少代码包体积：开启代码压缩，善用缓存，减少 http 请求</li><li>使用组件：将重复的功能进行统一的封装</li><li>在频繁操作的地方使用防抖或节流，比如 onPageScoll</li><li>封装重复逻辑，比如用 promise 封装 wx.request。</li></ul><p><strong>如何测试优化结果</strong></p><ul><li>使用 audits （体验评分）工具，浏览器中对应 Proformance - 查看首屏加载时长 - 网络请求时长 - 通过给出的体验报告，去逐步进行优化。</li></ul><h2 id="遇到的问题-以及如何解决的。" tabindex="-1"><a class="header-anchor" href="#遇到的问题-以及如何解决的。" aria-hidden="true">#</a> 遇到的问题，以及如何解决的。</h2><p><strong>页面栈爆栈</strong></p><ul><li>小程序默认页面栈是 10 层，超出则会跳转失败。</li><li>自己封装一个 router，每次跳转时判断一下，如果到了 9 层，在调转就使用 wx.redirectTo</li></ul><p><strong>异步问题</strong></p><ul><li>很多的 API 都是异步的，比如 wx.request</li><li>为了方便使用，将异步封装为 promise</li></ul><p><strong>wxss 编写问题</strong></p><ul><li>wxss 编写太原生</li><li>使用 easy-less 或者 webpack 写 less 然后转换为 wxss</li></ul><p><strong>IphoneX 的适配</strong></p><ul><li>适配下边框 20rpx</li><li>通过判断设备类型来编写适配代码。</li></ul><p><strong>相机拍照后照片转 base64</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> base64Img <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getFileSystemManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>temPath<span class="token punctuation">,</span> <span class="token string">&quot;base64&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><strong>小程序自定义 Less</strong></p>',21),l=(0,t.Uk)("参考："),p={href:"https://juejin.cn/post/6856649674020012045",target:"_blank",rel:"noopener noreferrer"},o=(0,t.Uk)("在微信小程序中使用 less(最优方式)"),i=(0,t.uE)('<p><strong>小程序 wxml 属性如何折行</strong></p><p>setting.json 中：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;files.associations&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token string">&quot;*.wxss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;*.wxs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;*.wxml&quot;</span><span class="token operator">:</span> <span class="token string">&quot;html&quot;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n<span class="token string">&quot;html.format.wrapAttributes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;force-aligned&quot;</span><span class="token punctuation">,</span>\n\n<span class="token string">&quot;[html]&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n\t<span class="token string">&quot;editor.defaultFormatter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HookyQR.beautify&quot;</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="组件相关" tabindex="-1"><a class="header-anchor" href="#组件相关" aria-hidden="true">#</a> 组件相关</h2><p><strong>自定义 navbar</strong></p><p>参考：https://www.cnblogs.com/sese/p/9761713.html</p><p><strong>小程序热更新</strong></p><ul><li>参考：https://www.cnblogs.com/zjy850984598/p/11016748.html</li><li>官方文档(getUpdateManager)：https://developers.weixin.qq.com/miniprogram/dev/api/base/update/wx.getUpdateManager.html</li></ul><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他" aria-hidden="true">#</a> 其他</h2><p><strong>小程序和 Vue 的区别</strong></p><ul><li>运行环境</li><li>声明周期</li><li>代码编写</li><li>组件通讯</li><li>对于特定的功能，小程序需要基础的支持</li></ul><p><strong>TypeScript 给你带来了什么？</strong></p><ul><li>开发阶段的静态类型检测</li><li>友好的阅读体验</li><li>类，接口，泛型的提供</li></ul>',13),r={render:function(s,n){const a=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.iD)(t.HY,null,[e,(0,t._)("p",null,[l,(0,t._)("a",p,[o,(0,t.Wm)(a)])]),i],64)}}}}]);